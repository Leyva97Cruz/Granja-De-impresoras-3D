[{"id":"780ee33d.d4e32c","type":"tab","label":"Control Node red","disabled":false,"info":""},{"id":"32a6e9a4.729726","type":"subflow","name":"List Files","info":"","in":[{"x":180,"y":80,"wires":[{"id":"d6c00302.22b7"}]}],"out":[{"x":680,"y":60,"wires":[{"id":"276efe60.e43bc2","port":0}]}]},{"id":"95bffdae.d288a","type":"subflow","name":"FIle Upload","info":"","category":"","in":[],"out":[],"env":[{"name":"UPLOAD_DIR","type":"str","value":"."}],"color":"#DDAA99"},{"id":"a0184fc7.0f683","type":"ui_group","z":"","name":"Ender 1","tab":"","disp":true,"width":22,"collapse":false},{"id":"a6e80f29.c2905","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"3b6058c6.bae588","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":1,"width":1,"height":1},{"id":"f476cda8.60113","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":3,"width":1,"height":1},{"id":"7895bb6f.8dfda4","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":5,"width":1,"height":1},{"id":"a8426049.9a5f6","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":7,"width":1,"height":1},{"id":"3c90bfd9.5188b","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":8,"width":1,"height":1},{"id":"4991a3bb.3cdaec","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":9,"width":1,"height":1},{"id":"5029d44b.01bb9c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":10,"width":1,"height":1},{"id":"a6a40b7e.923c78","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":12,"width":1,"height":1},{"id":"7099710c.b9113","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":13,"width":1,"height":1},{"id":"e1a4066f.508a28","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":14,"width":1,"height":1},{"id":"8ccf4c3c.5818a","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":15,"width":1,"height":1},{"id":"f455c132.89262","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":16,"width":1,"height":1},{"id":"eaca9924.b58618","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":17,"width":1,"height":1},{"id":"9319c91b.7a2328","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":18,"width":1,"height":1},{"id":"d87f5f43.7fe8","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":19,"width":1,"height":1},{"id":"1710c2b9.d5d1fd","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":20,"width":1,"height":1},{"id":"9ba8b2a9.f2e91","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":21,"width":1,"height":1},{"id":"237a4360.61701c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":22,"width":1,"height":1},{"id":"5ca5bdc9.917af4","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":23,"width":1,"height":1},{"id":"555f0855.ac3368","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":24,"width":1,"height":1},{"id":"38a4d463.84254c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":27,"width":11,"height":1},{"id":"cb6ffb58.69eda8","type":"ui_group","z":"","name":"Video Frame","tab":"","disp":true,"width":"11","collapse":false},{"id":"b3d9815b.dab9d","type":"ui_group","z":"","name":"Temp","tab":"","order":3,"disp":true,"width":"6","collapse":false},{"id":"66230c3d.c47184","type":"ui_group","z":"","name":"Move","tab":"","order":4,"disp":true,"width":"6","collapse":false},{"id":"6fd7e574.ea2dfc","type":"ui_group","z":"","name":"Control","tab":"","order":2,"disp":true,"width":"6","collapse":false},{"id":"302277f6.dc9148","type":"ui_group","z":"","name":"Fila Change","tab":"","order":1,"disp":true,"width":"6","collapse":false},{"id":"567360f3.7b58c","type":"http proxy","z":"","name":"","url":"http://192.168.1.7/ender1/","noproxy":[]},{"id":"ba7d5fbc.c46ad","type":"ui_group","z":"","name":"T1","tab":"","disp":true,"width":"6","collapse":false},{"id":"41959110.00eca","type":"serial-port","z":"","serialport":"/dev/ttyUSB0","serialbaud":"115200","databits":"8","parity":"none","stopbits":"1","waitfor":"","dtr":"none","rts":"none","cts":"none","dsr":"none","newline":"200","bin":"false","out":"time","addchar":"","responsetimeout":"10"},{"id":"be47845d.7f93d8","type":"serial-port","z":"","serialport":"","serialbaud":"57600","databits":"8","parity":"none","stopbits":"1","waitfor":"","dtr":"none","rts":"none","cts":"none","dsr":"none","newline":"\\n","bin":"false","out":"char","addchar":"","responsetimeout":"10000"},{"id":"2f1bb395.6d339c","type":"ui_tab","z":"","name":"Granja  de impresoras 3D","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"a0bff555.3bebc8","type":"ui_group","z":"","name":"Granja 3D","tab":"2f1bb395.6d339c","disp":true,"width":"22","collapse":false},{"id":"56fe60ba.5d95c","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":1,"width":"2","height":"2"},{"id":"e67b5b4c.2c15d8","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":2,"width":1,"height":1},{"id":"548829c8.c60c58","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":4,"width":1,"height":1},{"id":"a268d621.9592b8","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":8,"width":1,"height":1},{"id":"9797b02c.7c8b6","type":"ui_group","z":"","name":"File upload","tab":"","order":4,"disp":true,"width":"6","collapse":false},{"id":"35cea8d7.dc3c18","type":"debug","z":"780ee33d.d4e32c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":295,"y":735,"wires":[]},{"id":"3b12b210.bebcfe","type":"function","z":"780ee33d.d4e32c","name":"Home","func":"var AutoHome={payload:\"G28\\r\\n\"}\nreturn AutoHome;","outputs":1,"noerr":0,"x":385,"y":104,"wires":[["a66644f3.68c538"]]},{"id":"525e1496.104f9c","type":"ui_button","z":"780ee33d.d4e32c","name":"Auto Home","group":"a0bff555.3bebc8","order":7,"width":"2","height":"1","passthru":true,"label":"","tooltip":"","color":"","bgcolor":"","icon":"home","payload":"","payloadType":"str","topic":"","x":225,"y":104,"wires":[["3b12b210.bebcfe"]]},{"id":"2dd77e85.95bec2","type":"ui_text","z":"780ee33d.d4e32c","group":"a0bff555.3bebc8","order":6,"width":"8","height":"1","name":"","label":"Status : ","format":"{{msg.payload}}","layout":"row-center","x":705,"y":690,"wires":[]},{"id":"a66644f3.68c538","type":"serial out","z":"780ee33d.d4e32c","name":"","serial":"41959110.00eca","x":825,"y":254,"wires":[]},{"id":"fe233d19.f7591","type":"serial in","z":"780ee33d.d4e32c","name":"","serial":"41959110.00eca","x":85,"y":705,"wires":[["b0f9a360.13cf2","e0099be6.9fc1a8","35cea8d7.dc3c18"]]},{"id":"eeb21a08.4ea1a8","type":"function","z":"780ee33d.d4e32c","name":"Status Tem","func":"var Listar_archivos_SD={payload:\"M105\\r\\n\"}\nreturn Listar_archivos_SD;","outputs":1,"noerr":0,"x":405,"y":149,"wires":[["a66644f3.68c538"]]},{"id":"7f7338a6.0466e8","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":194,"wires":[["33abb5f5.6ae08a"]]},{"id":"b0f9a360.13cf2","type":"split","z":"780ee33d.d4e32c","name":"","splt":"/","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":275,"y":645,"wires":[["ddee1b50.f28d58"]]},{"id":"ddee1b50.f28d58","type":"split","z":"780ee33d.d4e32c","name":"","splt":" ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":410,"y":645,"wires":[["5194000a.fbc62"]]},{"id":"5194000a.fbc62","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"T:","vt":"str"},{"t":"cont","v":"B:","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":545,"y":645,"wires":[["2a9cd9c2.a076e6"],["a2510fb5.065ef"]]},{"id":"a2510fb5.065ef","type":"split","z":"780ee33d.d4e32c","name":"Cama","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":695,"y":645,"wires":[["9b7b6475.42e2e8"]]},{"id":"2a9cd9c2.a076e6","type":"split","z":"780ee33d.d4e32c","name":"Extrusor","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":705,"y":600,"wires":[["ba267c55.609a3"]]},{"id":"ba267c55.609a3","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":845,"y":600,"wires":[["8a3452ae.589bb"]]},{"id":"9b7b6475.42e2e8","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":815,"y":645,"wires":[["f25c2734.d03678"]]},{"id":"e0099be6.9fc1a8","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"processing","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":275,"y":690,"wires":[["cd5136ed.0529a8"]]},{"id":"8a3452ae.589bb","type":"ui_gauge","z":"780ee33d.d4e32c","name":"","group":"a0bff555.3bebc8","order":3,"width":"6","height":"4","gtype":"gage","title":"Extrusor","label":"units","format":"{{value}}","min":0,"max":"250","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":975,"y":600,"wires":[]},{"id":"f25c2734.d03678","type":"ui_gauge","z":"780ee33d.d4e32c","name":"","group":"a0bff555.3bebc8","order":5,"width":"6","height":"4","gtype":"gage","title":"Cama","label":"units","format":"{{value}}","min":0,"max":"70","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":950,"y":645,"wires":[]},{"id":"62ef699a.cca218","type":"ui_button","z":"780ee33d.d4e32c","name":"Temperatura","group":"a0bff555.3bebc8","order":9,"width":"3","height":"1","passthru":false,"label":"Temperatura","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":225,"y":149,"wires":[["eeb21a08.4ea1a8"]]},{"id":"33abb5f5.6ae08a","type":"function","z":"780ee33d.d4e32c","name":"G00","func":"var Mover={payload:\"G00 X50 Y90 Z10\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":385,"y":194,"wires":[["a66644f3.68c538"]]},{"id":"fb77fd1c.231d7","type":"function","z":"780ee33d.d4e32c","name":"Info Firmaware","func":"var Info_firmaware={payload:\"M115\\r\\n\"}\nreturn Info_firmaware;","outputs":1,"noerr":0,"x":415,"y":239,"wires":[["a66644f3.68c538"]]},{"id":"254721c5.641e9e","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":239,"wires":[["fb77fd1c.231d7"]]},{"id":"10912f05.2fc2c1","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":284,"wires":[["241de004.631ad"]]},{"id":"241de004.631ad","type":"function","z":"780ee33d.d4e32c","name":"Escribir Archivo","func":"var Inicio={payload:\"M28 Ejemplo.gcode\\r\\n\"};\nvar Linea1={payload:\"G28\\r\\n\"};\nvar Linea2={payload:\"G00 X50 Y90 Z10\\r\\n\"};\nvar Linea3={payload:\"G00 X40 Y90 Z10\\r\\n\"};\nvar Linea4={payload:\"G00 X50 Y50 Z10\\r\\n\"};\nvar Fin={payload:\"M29\\r\\n\"};\nreturn [ [ Inicio, Linea1, Linea2, Linea3, Linea4, Fin ]];\n\n/*for(var i=0;i<=3;i++)\n{\n    return mensajes[i];\n}*/\n\n","outputs":1,"noerr":0,"x":415,"y":284,"wires":[["a66644f3.68c538"]]},{"id":"e5afbab1.d7d058","type":"function","z":"780ee33d.d4e32c","name":"Eliminar","func":"var Inicio={payload:\"M30 Ejemplo.gcode\\r\\n\"};\nvar Linea1={payload:\"M30 Ejemplo.txt\\r\\n\"};\nreturn Linea1;\n//return [ [ Inicio, Linea1 ]];\n\n","outputs":1,"noerr":0,"x":395,"y":329,"wires":[["a66644f3.68c538"]]},{"id":"ad6f4d6a.1e8cd","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":329,"wires":[["e5afbab1.d7d058"]]},{"id":"d6c00302.22b7","type":"exec","z":"32a6e9a4.729726","command":"ls","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":310,"y":80,"wires":[["276efe60.e43bc2"],[],[]]},{"id":"276efe60.e43bc2","type":"change","z":"32a6e9a4.729726","name":"split","rules":[{"t":"set","p":"payload","pt":"msg","to":"$split(payload, '\\n')[$ != \"\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":60,"wires":[[]]},{"id":"546a1b4c.34d3c4","type":"http in","z":"95bffdae.d288a","name":"","url":"/fileupload","method":"post","upload":true,"swaggerDoc":"","x":140,"y":440,"wires":[["d1581181.7008c","b5c4c3a.c48504"]]},{"id":"ce173b7a.59b848","type":"http response","z":"95bffdae.d288a","name":"","statusCode":"","headers":{},"x":850,"y":440,"wires":[]},{"id":"b93c3c46.c966b","type":"ui_template","z":"95bffdae.d288a","group":"9797b02c.7c8b6","name":"Upload","order":1,"width":"6","height":"3","format":"<form id=\"upload_form\" enctype=\"multipart/form-data\" method=\"post\">\n    <input type=\"file\" name=\"file1\" id=\"file1\"><br>\n    <input type=\"button\" value=\"Upload File\" onclick=\"uploadFile()\">\n    <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n    <p id=\"status\"></p>\n    <p id=\"loaded_n_total\"></p>\n</form>\n\n<script>\n    function _(el){\n    return document.getElementById(el);\n}\nfunction uploadFile(){\n    var file = _(\"file1\").files[0];\n    // alert(file.name+\" | \"+file.size+\" | \"+file.type);\n    var formdata = new FormData();\n    formdata.append(\"file1\", file);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/fileupload\");\n    ajax.send(formdata);\n}\nfunction progressHandler(event){\n    _(\"loaded_n_total\").innerHTML = \"Uploaded \"+event.loaded+\" bytes of \"+event.total;\n    var percent = (event.loaded / event.total) * 100;\n    _(\"progressBar\").value = Math.round(percent);\n    _(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    _(\"status\").innerHTML = event.target.responseText;\n    _(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    _(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    _(\"status\").innerHTML = \"Upload Aborted\";\n}\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":120,"y":400,"wires":[[]]},{"id":"401a6c6f.228764","type":"subflow:32a6e9a4.729726","z":"95bffdae.d288a","name":"","env":[],"x":520,"y":140,"wires":[["a82a8c6b.831eb"]]},{"id":"dda50a49.28a8b8","type":"ui_dropdown","z":"95bffdae.d288a","name":"","label":"","tooltip":"","place":"Select option","group":"9797b02c.7c8b6","order":0,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"","x":890,"y":140,"wires":[["25692c33.216e64"]]},{"id":"a82a8c6b.831eb","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"options","pt":"msg","to":"payload","tot":"msg"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":140,"wires":[["dda50a49.28a8b8"]]},{"id":"8dbdcfb.9fe483","type":"link in","z":"95bffdae.d288a","name":"refreshFileDropdown","links":["9e15981.7212a68","1e5aeecf.9d3091"],"x":75,"y":140,"wires":[["5900eeb8.22f3b"]]},{"id":"34918529.8c79fa","type":"ui_button","z":"95bffdae.d288a","name":"","group":"9797b02c.7c8b6","order":0,"width":0,"height":0,"passthru":false,"label":"Delete","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":110,"y":220,"wires":[["41cefd6.cccd404"]]},{"id":"25692c33.216e64","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"selectedFile","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1100,"y":140,"wires":[[]]},{"id":"d1581181.7008c","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"filename","pt":"msg","to":"$env('UPLOAD_DIR')  & '/' & req.files[0].originalname","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"req.files[0].buffer","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":360,"wires":[["ee1b9f6.931b16","9e15981.7212a68"]]},{"id":"ee1b9f6.931b16","type":"file","z":"95bffdae.d288a","name":"","filename":"","appendNewline":false,"createDir":false,"overwriteFile":"true","x":770,"y":360,"wires":[[]]},{"id":"e015547f.791248","type":"inject","z":"95bffdae.d288a","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":130,"y":80,"wires":[["5900eeb8.22f3b"]]},{"id":"41cefd6.cccd404","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"filename","pt":"msg","to":"$env('UPLOAD_DIR')  & '/' & $flowContext('selectedFile')","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"Delete File ?","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":220,"wires":[["691de655.62c4e8"]]},{"id":"4764d947.92bcf8","type":"file","z":"95bffdae.d288a","name":"","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"delete","x":770,"y":220,"wires":[[]]},{"id":"691de655.62c4e8","type":"ui_toast","z":"95bffdae.d288a","position":"dialog","displayTime":"3","highlight":"","outputs":1,"ok":"OK","cancel":"Cancel","topic":"","name":"","x":470,"y":220,"wires":[["8d1384e.474fb78"]]},{"id":"8d1384e.474fb78","type":"switch","z":"95bffdae.d288a","name":"OK ?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"OK","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":630,"y":220,"wires":[["4764d947.92bcf8","1e5aeecf.9d3091"]]},{"id":"a92b5792.264778","type":"catch","z":"95bffdae.d288a","name":"","scope":null,"x":120,"y":500,"wires":[["d78629a0.810178"]]},{"id":"ae813e1f.4780e","type":"ui_toast","z":"95bffdae.d288a","position":"top right","displayTime":"3","highlight":"","outputs":0,"ok":"OK","cancel":"","topic":"","name":"","x":530,"y":500,"wires":[]},{"id":"d78629a0.810178","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"error.message","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":500,"wires":[["ae813e1f.4780e"]]},{"id":"1e5aeecf.9d3091","type":"link out","z":"95bffdae.d288a","name":"refreshAfterDelete","links":["8dbdcfb.9fe483"],"x":735,"y":260,"wires":[]},{"id":"9e15981.7212a68","type":"link out","z":"95bffdae.d288a","name":"refreshAfterUpload","links":["8dbdcfb.9fe483"],"x":735,"y":400,"wires":[]},{"id":"b5c4c3a.c48504","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"'File ' & req.files[0].originalname & ' uploaded.'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":440,"wires":[["ce173b7a.59b848"]]},{"id":"5900eeb8.22f3b","type":"delay","z":"95bffdae.d288a","name":"","pauseType":"delay","timeout":"100","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":190,"y":140,"wires":[["c950f136.4fa41"]]},{"id":"c950f136.4fa41","type":"change","z":"95bffdae.d288a","name":"basePath","rules":[{"t":"set","p":"payload","pt":"msg","to":"UPLOAD_DIR","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":140,"wires":[["401a6c6f.228764"]]},{"id":"443c6fa9.9433f","type":"watch","z":"95bffdae.d288a","name":"","files":"$(UPLOAD_DIR)","recursive":"","x":140,"y":40,"wires":[["5900eeb8.22f3b"]]},{"id":"cd5136ed.0529a8","type":"split","z":"780ee33d.d4e32c","name":"","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":425,"y":690,"wires":[["ecbc730f.c8efc"]]},{"id":"ecbc730f.c8efc","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"processing","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":545,"y":690,"wires":[["2dd77e85.95bec2"]]},{"id":"57159658.2e1578","type":"function","z":"780ee33d.d4e32c","name":"Status Impresion SD","func":"var Mover={payload:\"M27\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":435,"y":374,"wires":[["a66644f3.68c538"]]},{"id":"44a60f63.cb17d","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":374,"wires":[["57159658.2e1578"]]},{"id":"93e6aba4.bd8fa8","type":"function","z":"780ee33d.d4e32c","name":"Archivos SD","func":"var Mover={payload:\"M20\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":405,"y":419,"wires":[["a66644f3.68c538"]]},{"id":"4db2c4f.d25433c","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":419,"wires":[["93e6aba4.bd8fa8"]]},{"id":"f3a92d1b.79d23","type":"function","z":"780ee33d.d4e32c","name":"Imprimir Archivo desde SD","func":"var Inicio={payload:\"M23 CE3_PI~1.GCO\\r\\n\"};\nvar Fin={payload:\"M24\\r\\n\"};\nreturn [ [ Inicio, Fin ]];\n\n/*for(var i=0;i<=3;i++)\n{\n    return mensajes[i];\n}*/\n\n","outputs":1,"noerr":0,"x":455,"y":464,"wires":[["a66644f3.68c538"]]},{"id":"ebbd5ca5.04ff7","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":464,"wires":[["f3a92d1b.79d23"]]},{"id":"783ddfbc.9fb8c","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":60,"wires":[["525e1496.104f9c"]]},{"id":"5996c0c2.e038e","type":"function","z":"780ee33d.d4e32c","name":"Init SD","func":"msg.payload = \"M21\\r\\n M20\\r\\n\"\nreturn msg\n\n","outputs":1,"noerr":0,"x":390,"y":520,"wires":[["a66644f3.68c538"]]},{"id":"4efeca4b.8af9e4","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":520,"wires":[["5996c0c2.e038e"]]}]