[{"id":"780ee33d.d4e32c","type":"tab","label":"Control Node red","disabled":false,"info":""},{"id":"d89bb856.b9ba88","type":"tab","label":"Status de la impresora","disabled":true,"info":""},{"id":"5ff6ad5c.eb3134","type":"tab","label":"Flow 1","disabled":true,"info":""},{"id":"e18e2c0b.e315","type":"tab","label":"Flow 2","disabled":true,"info":""},{"id":"32a6e9a4.729726","type":"subflow","name":"List Files","info":"","in":[{"x":180,"y":80,"wires":[{"id":"d6c00302.22b7"}]}],"out":[{"x":680,"y":60,"wires":[{"id":"276efe60.e43bc2","port":0}]}]},{"id":"95bffdae.d288a","type":"subflow","name":"FIle Upload","info":"","category":"","in":[],"out":[],"env":[{"name":"UPLOAD_DIR","type":"str","value":"."}],"color":"#DDAA99"},{"id":"a0184fc7.0f683","type":"ui_group","z":"","name":"Ender 1","tab":"f02b1711.618eb8","disp":true,"width":22,"collapse":false},{"id":"f02b1711.618eb8","type":"ui_tab","z":"","name":"Inventoteca","icon":"dashboard","disabled":false,"hidden":false},{"id":"a6e80f29.c2905","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"3b6058c6.bae588","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":1,"width":1,"height":1},{"id":"f476cda8.60113","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":3,"width":1,"height":1},{"id":"7895bb6f.8dfda4","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":5,"width":1,"height":1},{"id":"a8426049.9a5f6","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":7,"width":1,"height":1},{"id":"3c90bfd9.5188b","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":8,"width":1,"height":1},{"id":"4991a3bb.3cdaec","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":9,"width":1,"height":1},{"id":"5029d44b.01bb9c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":10,"width":1,"height":1},{"id":"a6a40b7e.923c78","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":12,"width":1,"height":1},{"id":"7099710c.b9113","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":13,"width":1,"height":1},{"id":"e1a4066f.508a28","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":14,"width":1,"height":1},{"id":"8ccf4c3c.5818a","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":15,"width":1,"height":1},{"id":"f455c132.89262","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":16,"width":1,"height":1},{"id":"eaca9924.b58618","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":17,"width":1,"height":1},{"id":"9319c91b.7a2328","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":18,"width":1,"height":1},{"id":"d87f5f43.7fe8","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":19,"width":1,"height":1},{"id":"1710c2b9.d5d1fd","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":20,"width":1,"height":1},{"id":"9ba8b2a9.f2e91","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":21,"width":1,"height":1},{"id":"237a4360.61701c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":22,"width":1,"height":1},{"id":"5ca5bdc9.917af4","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":23,"width":1,"height":1},{"id":"555f0855.ac3368","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":24,"width":1,"height":1},{"id":"38a4d463.84254c","type":"ui_spacer","name":"spacer","group":"a0184fc7.0f683","order":27,"width":11,"height":1},{"id":"cb6ffb58.69eda8","type":"ui_group","z":"","name":"Video Frame","tab":"4408002d.61f5","disp":true,"width":"11","collapse":false},{"id":"b3d9815b.dab9d","type":"ui_group","z":"","name":"Temp","tab":"4408002d.61f5","order":3,"disp":true,"width":"6","collapse":false},{"id":"66230c3d.c47184","type":"ui_group","z":"","name":"Move","tab":"4408002d.61f5","order":4,"disp":true,"width":"6","collapse":false},{"id":"6fd7e574.ea2dfc","type":"ui_group","z":"","name":"Control","tab":"4408002d.61f5","order":2,"disp":true,"width":"6","collapse":false},{"id":"302277f6.dc9148","type":"ui_group","z":"","name":"Fila Change","tab":"f9a81d1b.0af96","order":1,"disp":true,"width":"6","collapse":false},{"id":"4408002d.61f5","type":"ui_tab","z":"","name":"I3 Mega","icon":"dashboard","order":15,"disabled":false,"hidden":false},{"id":"f9a81d1b.0af96","type":"ui_tab","z":"","name":"Filament Change","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"567360f3.7b58c","type":"http proxy","z":"","name":"","url":"http://192.168.1.7/ender1/","noproxy":[]},{"id":"ba7d5fbc.c46ad","type":"ui_group","z":"","name":"T1","tab":"","disp":true,"width":"6","collapse":false},{"id":"41959110.00eca","type":"serial-port","z":"","serialport":"/dev/ttyUSB0","serialbaud":"115200","databits":"8","parity":"none","stopbits":"1","waitfor":"","dtr":"none","rts":"none","cts":"none","dsr":"none","newline":"200","bin":"false","out":"time","addchar":"","responsetimeout":"10"},{"id":"be47845d.7f93d8","type":"serial-port","z":"","serialport":"","serialbaud":"57600","databits":"8","parity":"none","stopbits":"1","waitfor":"","dtr":"none","rts":"none","cts":"none","dsr":"none","newline":"\\n","bin":"false","out":"char","addchar":"","responsetimeout":"10000"},{"id":"2f1bb395.6d339c","type":"ui_tab","z":"","name":"Granja  de impresoras 3D","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"a0bff555.3bebc8","type":"ui_group","z":"","name":"Granja 3D","tab":"2f1bb395.6d339c","disp":true,"width":"22","collapse":false},{"id":"56fe60ba.5d95c","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":1,"width":"2","height":"2"},{"id":"e67b5b4c.2c15d8","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":2,"width":1,"height":1},{"id":"548829c8.c60c58","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":4,"width":1,"height":1},{"id":"a268d621.9592b8","type":"ui_spacer","name":"spacer","group":"a0bff555.3bebc8","order":8,"width":1,"height":1},{"id":"9797b02c.7c8b6","type":"ui_group","z":"","name":"File upload","tab":"c1ab2387.45334","order":4,"disp":true,"width":"6","collapse":false},{"id":"c1ab2387.45334","type":"ui_tab","z":"","name":"File Upload","icon":"dashboard","order":2},{"id":"444cb229.bb38fc","type":"exec","z":"d89bb856.b9ba88","command":"curl -H \"X-Api-Key: E7075122DA52487BBFCBE1C241CCE952\" -X GET http://192.168.1.7/ender1/api/printer","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Status","x":230,"y":45,"wires":[["6a04b1bd.5c989"],[],[]]},{"id":"6a04b1bd.5c989","type":"split","z":"d89bb856.b9ba88","name":"llave","splt":"}","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":350,"y":30,"wires":[["3e1f8b0b.f90614"]]},{"id":"3e1f8b0b.f90614","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"temperature\":","vt":"str"},{"t":"cont","v":"\"tool0\":","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":485,"y":30,"wires":[["338cc0ca.5a315"],["2e0e9384.483d2c"]]},{"id":"338cc0ca.5a315","type":"split","z":"d89bb856.b9ba88","name":"Coma","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":665,"y":30,"wires":[["67a72082.7abd"]]},{"id":"67a72082.7abd","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"actual\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":785,"y":30,"wires":[["d8a9347f.85f6b8"]]},{"id":"d8a9347f.85f6b8","type":"split","z":"d89bb856.b9ba88","name":"llave {","splt":"{","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":920,"y":30,"wires":[["1aae1a86.31a6b5"]]},{"id":"1aae1a86.31a6b5","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"actual\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1070,"y":30,"wires":[["3366ff2a.da599"]]},{"id":"bcce56fd.d563a8","type":"ui_gauge","z":"d89bb856.b9ba88","name":"Temperatura","group":"a0184fc7.0f683","order":4,"width":6,"height":5,"gtype":"gage","title":"Temperatura de La Cama","label":"C째","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":1540,"y":75,"wires":[]},{"id":"3366ff2a.da599","type":"split","z":"d89bb856.b9ba88","name":"Dos Puntos","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1195,"y":75,"wires":[["258604d9.2e16ac"]]},{"id":"3b084b6a.064274","type":"ui_button","z":"d89bb856.b9ba88","name":"","group":"a0184fc7.0f683","order":6,"width":6,"height":1,"passthru":false,"label":"Status","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":65,"y":225,"wires":[["f12f200b.46ce5"]]},{"id":"4c8aa28a.7b9b3c","type":"ui_chart","z":"d89bb856.b9ba88","name":"","group":"a0184fc7.0f683","order":11,"width":6,"height":4,"label":"Temperatura Actual","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#e10000","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1485,"y":180,"wires":[[]]},{"id":"2e0e9384.483d2c","type":"split","z":"d89bb856.b9ba88","name":"Coma","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":620,"y":105,"wires":[["95bfc53b.4c1408"]]},{"id":"95bfc53b.4c1408","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"actual\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":740,"y":135,"wires":[["60f91b3e.458d44"]]},{"id":"60f91b3e.458d44","type":"split","z":"d89bb856.b9ba88","name":"llave {","splt":"{","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":860,"y":135,"wires":[["1c4ef1b.a38750e"]]},{"id":"1c4ef1b.a38750e","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"actual\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":980,"y":165,"wires":[["5a302b81.6aaf94"]]},{"id":"5a302b81.6aaf94","type":"split","z":"d89bb856.b9ba88","name":"Dos Puntos","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":1120,"y":165,"wires":[["2eb8d72.296c528"]]},{"id":"ee9e04a3.8dcd08","type":"ui_gauge","z":"d89bb856.b9ba88","name":"Temperatura","group":"a0184fc7.0f683","order":2,"width":6,"height":5,"gtype":"gage","title":"Temperatura De Extrucsor","label":"C째","format":"{{value}}","min":0,"max":"240","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":1480,"y":240,"wires":[]},{"id":"1082aa73.c651b6","type":"inject","z":"d89bb856.b9ba88","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":45,"wires":[["444cb229.bb38fc"]]},{"id":"e44c00f.b96c8","type":"split","z":"d89bb856.b9ba88","name":"Coma","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":590,"y":210,"wires":[["6066e7e.dc82218"]]},{"id":"6066e7e.dc82218","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"Operational\"","vt":"str"},{"t":"cont","v":"\"Printing\"","vt":"str"},{"t":"eq","v":"\"Printer is not operational\"","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":725,"y":210,"wires":[["d603eb89.5e8f38"],["eca29238.65eca"],["f5ad66f9.4839c8"]]},{"id":"d603eb89.5e8f38","type":"change","z":"d89bb856.b9ba88","name":"Op","rules":[{"t":"change","p":"payload","pt":"msg","from":"\"Operational\"","fromt":"str","to":"Operacional","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":875,"y":195,"wires":[["4f71db9a.9b6bc4"]]},{"id":"eca29238.65eca","type":"change","z":"d89bb856.b9ba88","name":"Op","rules":[{"t":"change","p":"payload","pt":"msg","from":"\"Printing\"","fromt":"str","to":"Imprimendo","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":875,"y":240,"wires":[["4f71db9a.9b6bc4"]]},{"id":"f12f200b.46ce5","type":"exec","z":"d89bb856.b9ba88","command":"curl -H \"X-Api-Key: E7075122DA52487BBFCBE1C241CCE952\" -X GET http://192.168.1.7/ender1/api/printer","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Status","x":185,"y":225,"wires":[["7828874c.c2d668"],[],[]]},{"id":"7828874c.c2d668","type":"split","z":"d89bb856.b9ba88","name":"llave","splt":"}","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":305,"y":210,"wires":[["18e920d3.cd112f"]]},{"id":"18e920d3.cd112f","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"text\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":455,"y":210,"wires":[["e44c00f.b96c8"]]},{"id":"4f71db9a.9b6bc4","type":"ui_text","z":"d89bb856.b9ba88","group":"a0184fc7.0f683","order":25,"width":6,"height":1,"name":"LblStatus","label":"","format":"{{msg.payload}}","layout":"col-center","x":1080,"y":225,"wires":[]},{"id":"feb0b92d.e1f198","type":"inject","z":"5ff6ad5c.eb3134","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":45,"wires":[["312db007.6959d"]]},{"id":"6cb53ab5.189e44","type":"debug","z":"5ff6ad5c.eb3134","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1795,"y":150,"wires":[]},{"id":"ab68d856.77d288","type":"switch","z":"5ff6ad5c.eb3134","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"\"resource\"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":575,"y":45,"wires":[["e158f6bd.9476f8"]]},{"id":"312db007.6959d","type":"exec","z":"5ff6ad5c.eb3134","command":"curl -H \"X-Api-Key: E7075122DA52487BBFCBE1C241CCE952\" -X GET http://192.168.1.7/ender1/api/files","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Archivos","x":225,"y":60,"wires":[["f742a848.7f74f8"],[],[]]},{"id":"f742a848.7f74f8","type":"split","z":"5ff6ad5c.eb3134","name":"llave","splt":"{","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":380,"y":75,"wires":[["b41e3f41.7b8b7"]]},{"id":"76742cf7.1f6174","type":"switch","z":"5ff6ad5c.eb3134","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"http","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":830,"y":30,"wires":[["e0c0ccbe.b8055"]]},{"id":"b41e3f41.7b8b7","type":"split","z":"5ff6ad5c.eb3134","name":"Coma","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":455,"y":15,"wires":[["ab68d856.77d288"]]},{"id":"e158f6bd.9476f8","type":"split","z":"5ff6ad5c.eb3134","name":"Comillas","splt":"\"","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":705,"y":45,"wires":[["76742cf7.1f6174"]]},{"id":"e0c0ccbe.b8055","type":"split","z":"5ff6ad5c.eb3134","name":"Diagonal","splt":"/","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":975,"y":60,"wires":[["685905ca.eb1d7c"]]},{"id":"685905ca.eb1d7c","type":"switch","z":"5ff6ad5c.eb3134","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":".gcode","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1130,"y":60,"wires":[["808ffb2c.ab64b8"]]},{"id":"1eb7f351.f0aa3d","type":"exec","z":"5ff6ad5c.eb3134","command":"curl -H \"X-Api-Key: E7075122DA52487BBFCBE1C241CCE952\" -X POST -H \"Content-Type:application/json\" -d '{  \"command\": \"select\",  \"print\": true}' http://192.168.1.7/ender1/api/files/local/CE3_Helicoidal.gcode","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Imprimir","x":360,"y":210,"wires":[["2ae75418.7ac01c"],[],[]]},{"id":"e322b552.6ac888","type":"ui_button","z":"5ff6ad5c.eb3134","name":"","group":"a0184fc7.0f683","order":26,"width":5,"height":1,"passthru":false,"label":"Imprimir","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":85,"y":150,"wires":[["1eb7f351.f0aa3d"]]},{"id":"2ae75418.7ac01c","type":"debug","z":"5ff6ad5c.eb3134","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":625,"y":165,"wires":[]},{"id":"258604d9.2e16ac","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"actual","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1380,"y":90,"wires":[[],["bcce56fd.d563a8"]]},{"id":"2eb8d72.296c528","type":"switch","z":"d89bb856.b9ba88","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"actual","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":1295,"y":165,"wires":[[],["4c8aa28a.7b9b3c","ee9e04a3.8dcd08"]]},{"id":"9f709846.024698","type":"change","z":"e18e2c0b.e315","name":"Set Progress 0","rules":[{"t":"set","p":"payload.progress.completion","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":351.99997425079346,"wires":[["316ad66c.c9fcba"]]},{"id":"e0b5eb0c.fa0448","type":"ui_template","z":"e18e2c0b.e315","group":"cb6ffb58.69eda8","name":"Video Frame","order":1,"width":"10","height":"10","format":"<img width=\"16\" height=\"16\" src=\"{{flow.payload.webcam.on}}\" />","storeOutMessages":false,"fwdInMessages":true,"templateScope":"local","x":1075,"y":765,"wires":[[]]},{"id":"ba2ed38c.1d0f6","type":"http request","z":"e18e2c0b.e315","name":"","method":"use","ret":"txt","paytoqs":false,"url":"","tls":"","persist":false,"proxy":"","authType":"","x":630,"y":111.99997425079346,"wires":[["94e8d2f.144a93"]]},{"id":"1157b498.87eb2b","type":"ui_gauge","z":"e18e2c0b.e315","name":"","group":"b3d9815b.dab9d","order":4,"width":"0","height":"0","gtype":"gage","title":"Heatbed","label":"","format":"{{msg.payload.temperature.bed.actual}}째C","min":0,"max":"110","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":960,"y":191.99997425079346,"wires":[]},{"id":"15c0d37e.5e02dd","type":"ui_gauge","z":"e18e2c0b.e315","name":"","group":"b3d9815b.dab9d","order":2,"width":"0","height":"0","gtype":"gage","title":"Nozzle","label":"","format":"{{msg.payload.temperature.tool0.actual}}째C","min":0,"max":"250","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":950,"y":151.99997425079346,"wires":[]},{"id":"316ad66c.c9fcba","type":"ui_text","z":"e18e2c0b.e315","group":"b3d9815b.dab9d","order":1,"width":"2","height":"1","name":"","label":"Progress","format":"{{msg.payload.progress.completion | number:1}}%","layout":"row-left","x":920,"y":411.99997425079346,"wires":[]},{"id":"15de8c63.d357c4","type":"inject","z":"e18e2c0b.e315","name":"","topic":"I3_Mega","payload":"","payloadType":"date","repeat":"5","crontab":"","once":true,"onceDelay":"1","x":200,"y":91.99997425079346,"wires":[["da629bea.9196c8"]]},{"id":"70f0e4a9.18690c","type":"file in","z":"e18e2c0b.e315","name":"","filename":"apikey","format":"utf8","chunk":false,"sendError":false,"x":895,"y":605,"wires":[["c4485d63.adb96"]]},{"id":"c8cca15b.fd299","type":"inject","z":"e18e2c0b.e315","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":875,"y":545,"wires":[["70f0e4a9.18690c"]]},{"id":"5e6aedcd.4f7d34","type":"comment","z":"e18e2c0b.e315","name":"Load Config","info":"Read in the API Key and save the valua to an global var\nContent of the file:\n{\n  \"apikey\": \"Octoprint API Key\",\n  \"ip\": \"192.168.1.210\",\n  \"port\": \"5000\"\n}\n","x":70,"y":380,"wires":[]},{"id":"5908e1a0.04c3b","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":1,"width":0,"height":0,"passthru":false,"label":"+Y","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 Y10 F3000\" ] }","payloadType":"json","topic":"","x":497.9999828338623,"y":413.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"5dc8fcb5.f81d84","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":4,"width":0,"height":0,"passthru":false,"label":"-X","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 X-10 F3000\" ] }","payloadType":"json","topic":"","x":497.9999828338623,"y":453.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"493e829c.b3fcfc","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":3,"width":0,"height":0,"passthru":false,"label":"+X","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 X10 F3000\" ] }","payloadType":"json","topic":"","x":497.9999828338623,"y":493.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"a6b89b64.f725a8","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":2,"width":0,"height":0,"passthru":false,"label":"-Y","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 Y-10 F3000\" ] }","payloadType":"json","topic":"","x":497.9999828338623,"y":533.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"9eee4ae3.315b98","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":5,"width":0,"height":0,"passthru":false,"label":"Nozzle Up","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 Z10 F100\" ] }","payloadType":"json","topic":"","x":517.9999828338623,"y":573.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"eb1f2da6.a8a12","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"66230c3d.c47184","order":6,"width":0,"height":0,"passthru":false,"label":"Nozzle Down","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"commands\": [  \"G91\",\"G0 Z-10 F100\" ] }","payloadType":"json","topic":"","x":517.9999828338623,"y":613.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"c4485d63.adb96","type":"json","z":"e18e2c0b.e315","name":"","property":"payload","action":"","pretty":true,"x":895,"y":665,"wires":[["b8e97622.4d8298"]]},{"id":"da629bea.9196c8","type":"function","z":"e18e2c0b.e315","name":"GET MESSAGE","func":"var apikey=flow.get('apikey') || 0;\nvar port=flow.get('port') || 0;\nvar ip=flow.get('ip') || 0;\nmsg.headers = {};\nmsg.headers={\n         'Content-type':'application/json',\n         'X-Api-Key': apikey };\nvar url1 = \"http://\" + ip + \":\" + port + \"/api/printer\";\nvar url2 = \"http://\" + ip + \":\" + port + \"/api/job\";\n\n\nvar msg1={\"method\":\"GET\",\"headers\":msg.headers,\"url\":url1,\"api\":\"PRINTER\"};\nvar msg2={\"method\":\"GET\",\"headers\":msg.headers,\"url\":url2,\"api\":\"JOB\"};\n\nreturn [ [ msg1 , msg2 ] ];\n\n","outputs":1,"noerr":0,"x":440,"y":111.99997425079346,"wires":[["ba2ed38c.1d0f6"]]},{"id":"1764c3f.b794d3c","type":"function","z":"e18e2c0b.e315","name":"POST MESSAGE","func":"var apikey=flow.get('apikey') || 0;\nvar port=flow.get('port') || 0;\nvar ip=flow.get('ip') || 0;\n\n\nmsg.method = \"POST\";\nmsg.headers = {};\nmsg.headers={\n         'Content-type':'application/json',\n         'X-Api-Key': apikey };\nmsg.url = \"http://\" + ip + \"ender1/api/printer/command\";\nreturn msg;\n","outputs":1,"noerr":0,"x":450,"y":151.99997425079346,"wires":[["ba2ed38c.1d0f6"]]},{"id":"7d645d4d.6469c4","type":"link out","z":"e18e2c0b.e315","name":"","links":["7f71ab9b.d7afe4"],"x":642.9999828338623,"y":493.9999694824219,"wires":[]},{"id":"db2c9f4e.a233b","type":"json","z":"e18e2c0b.e315","name":"","property":"payload","action":"","pretty":false,"x":790,"y":231.99997425079346,"wires":[["1157b498.87eb2b","15c0d37e.5e02dd","191650c5.80322f","19ec1be8.989a94","903d7921.fe2778"]]},{"id":"456c91c7.02951","type":"json","z":"e18e2c0b.e315","name":"","property":"payload","action":"","pretty":false,"x":710,"y":311.99997425079346,"wires":[["a0a499d9.6ca1a8"]]},{"id":"94e8d2f.144a93","type":"switch","z":"e18e2c0b.e315","name":"","property":"api","propertyType":"msg","rules":[{"t":"cont","v":"PRINTER","vt":"str"},{"t":"cont","v":"JOB","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":231.99997425079346,"wires":[["db2c9f4e.a233b"],["456c91c7.02951"]]},{"id":"a0a499d9.6ca1a8","type":"switch","z":"e18e2c0b.e315","name":"","property":"payload.progress.completion","propertyType":"msg","rules":[{"t":"null"},{"t":"nnull"}],"checkall":"true","repair":false,"outputs":2,"x":730,"y":371.99997425079346,"wires":[["9f709846.024698"],["316ad66c.c9fcba"]]},{"id":"b8e97622.4d8298","type":"function","z":"e18e2c0b.e315","name":"","func":"flow.set(\"ip\", msg.payload.ip);\nflow.set(\"port\", msg.payload.port);\nflow.set(\"apikey\", msg.payload.apikey);\nflow.set(\"webcam\", msg.payload.webcam);\nreturn msg;\n","outputs":1,"noerr":0,"x":915,"y":725,"wires":[["e0b5eb0c.fa0448"]]},{"id":"6e98e4ee.3b754c","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"6fd7e574.ea2dfc","order":2,"width":0,"height":0,"passthru":false,"label":"Home","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"command\": \"G28\" }","payloadType":"json","topic":"","x":497.9999828338623,"y":373.9999694824219,"wires":[["7d645d4d.6469c4"]]},{"id":"7b3f2f5b.226e3","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"302277f6.dc9148","order":2,"width":0,"height":0,"passthru":false,"label":"Start Filament Change","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"command\": \"M600\" }","payloadType":"json","topic":"","x":280,"y":231.99997425079346,"wires":[["1764c3f.b794d3c"]]},{"id":"ca182bbf.b5bd58","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"302277f6.dc9148","order":3,"width":0,"height":0,"passthru":false,"label":"Load Filament","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"command\": \"LOAD_FILAMENT\" }","payloadType":"json","topic":"","x":260,"y":271.99997425079346,"wires":[["1764c3f.b794d3c"]]},{"id":"8879b473.3556a8","type":"ui_button","z":"e18e2c0b.e315","name":"","group":"302277f6.dc9148","order":5,"width":0,"height":0,"passthru":false,"label":"RESUME","tooltip":"","color":"","bgcolor":"{{msg.background}}","icon":"","payload":"{ \"command\": \"RESUME_MACRO\" }","payloadType":"json","topic":"","x":240,"y":311.99997425079346,"wires":[["1764c3f.b794d3c"]]},{"id":"f3237d62.9263f","type":"ui_chart","z":"e18e2c0b.e315","name":"","group":"6fd7e574.ea2dfc","order":8,"width":"5","height":"5","label":"Nozzle Timeline","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":"6","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"useOldStyle":false,"outputs":1,"x":1380,"y":311.99997425079346,"wires":[[]]},{"id":"191650c5.80322f","type":"change","z":"e18e2c0b.e315","name":"","rules":[{"t":"move","p":"msg.payload.temperature.tool0.actual","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1080,"y":311.99997425079346,"wires":[["f3237d62.9263f"]]},{"id":"19ec1be8.989a94","type":"ui_text","z":"e18e2c0b.e315","group":"6fd7e574.ea2dfc","order":1,"width":"2","height":"1","name":"","label":"State","format":"{{msg.payload.state.text}}","layout":"row-left","x":950,"y":231.99997425079346,"wires":[]},{"id":"903d7921.fe2778","type":"function","z":"e18e2c0b.e315","name":"print check","func":"var state = msg.payload.state.flags.printing;\nvar msg1 = { background:\"green\",enabled: true };\nvar msg2 = { background:\"red\", enabled: false };\nif ( state === true ){\n    global.set(\"state\",true);\n    return [msg1,msg2];\n} else {\n    global.set(\"state\",false);\n    return [msg2,msg1];\n}","outputs":2,"noerr":0,"x":970,"y":271.99997425079346,"wires":[["d8d0faa2.2ae858"],["ddcb9768.bf94f8"]]},{"id":"d8d0faa2.2ae858","type":"link out","z":"e18e2c0b.e315","name":"out_print_active","links":["6f11f563.3bfafc"],"x":1175,"y":191.99997425079346,"wires":[]},{"id":"694e69d.ebedc98","type":"link in","z":"e18e2c0b.e315","name":"in_print_nonactive","links":["ddcb9768.bf94f8"],"x":327.9999828338623,"y":493.9999694824219,"wires":[["6e98e4ee.3b754c","5908e1a0.04c3b","5dc8fcb5.f81d84","493e829c.b3fcfc","a6b89b64.f725a8","9eee4ae3.315b98","eb1f2da6.a8a12"]]},{"id":"6f11f563.3bfafc","type":"link in","z":"e18e2c0b.e315","name":"in_print_active","links":["d8d0faa2.2ae858","24dc6516.10ac5a","a2ba835f.9db6"],"x":115,"y":271.99997425079346,"wires":[["8879b473.3556a8","ca182bbf.b5bd58","7b3f2f5b.226e3"]]},{"id":"ddcb9768.bf94f8","type":"link out","z":"e18e2c0b.e315","name":"out_print_inactive","links":["694e69d.ebedc98"],"x":1195,"y":251.99997425079346,"wires":[]},{"id":"7f71ab9b.d7afe4","type":"link in","z":"e18e2c0b.e315","name":"Post_MESSAGE_IN","links":["953a2df4.46848","7d645d4d.6469c4"],"x":255,"y":151.99997425079346,"wires":[["1764c3f.b794d3c"]]},{"id":"a5cf940f.4623d8","type":"template","z":"e18e2c0b.e315","name":"","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n  \"apikey\": \"E7075122DA52487BBFCBE1C241CCE952\",\n  \"ip\": \"192.168.1.7\",\n  \"port\": \"Ender1\",\n  \"webcam\": \"http://127.0.0.1/video\"\n}","output":"json","x":402.0000114440918,"y":759.9999589920044,"wires":[["35b92f7b.c8e4b"]]},{"id":"2d09b1f0.42bc5e","type":"inject","z":"e18e2c0b.e315","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":242.0000114440918,"y":759.9999589920044,"wires":[["a5cf940f.4623d8"]]},{"id":"35b92f7b.c8e4b","type":"file","z":"e18e2c0b.e315","name":"","filename":"apikey","appendNewline":true,"createDir":false,"overwriteFile":"true","x":572.0000114440918,"y":759.9999589920044,"wires":[[]]},{"id":"664aaafe.8e25c4","type":"comment","z":"e18e2c0b.e315","name":"Write Config","info":"Read in the API Key and save the valua to an global var\nContent of the file:\n{\n  \"apikey\": \"Octoprint API Key\",\n  \"ip\": \"192.168.1.210\",\n  \"port\": \"5000\"\n}\n","x":90,"y":700,"wires":[]},{"id":"a5850374.84769","type":"function","z":"5ff6ad5c.eb3134","name":"","func":"\n//var op = [ {\"Choice 1\":\"1\"}, \"Choice 2\", {\"Choice 3\":\"3\"} ]\n//msg.options= op\n//return msg;\n\nlet op = msg.payload \nmsg.options= op\nreturn msg;\n/*msg.options = [];//create empty array\n\n//for(let i = 0; i < msg.payload.length; i++){\n        let row = msg.payload;//[i]; //get the row\n        let opt = {};//make new opt object\n        //opt[i] = row[i];//[i]; //add a propery to object called row[0] & set its value to row[1]\n        msg.options.push(row);//add the opt to array    \n  // }\n*/\nreturn msg;","outputs":1,"noerr":0,"x":1430,"y":60,"wires":[["7d3c8dec.cd85a4"]]},{"id":"7d3c8dec.cd85a4","type":"ui_dropdown","z":"5ff6ad5c.eb3134","name":"","label":"","tooltip":"","place":"Select option","group":"a0184fc7.0f683","order":27,"width":"10","height":"1","passthru":false,"options":[],"payload":"","topic":"","x":1590,"y":60,"wires":[["6cb53ab5.189e44"]]},{"id":"808ffb2c.ab64b8","type":"join","z":"5ff6ad5c.eb3134","name":"Areglo","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"topic","joiner":":","joinerType":"str","accumulate":false,"timeout":"","count":"13","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":1265,"y":60,"wires":[["a5850374.84769"]]},{"id":"e7d4881f.c24bc8","type":"exec","z":"5ff6ad5c.eb3134","command":" ","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"Archivo","x":465,"y":375,"wires":[["ea116bbd.2dfb48"],[],[]]},{"id":"ea116bbd.2dfb48","type":"debug","z":"5ff6ad5c.eb3134","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":685,"y":345,"wires":[]},{"id":"47abc662.7ce8c8","type":"join","z":"5ff6ad5c.eb3134","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"/","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":305,"y":315,"wires":[["e7d4881f.c24bc8"]]},{"id":"af40c3c8.11341","type":"inject","z":"5ff6ad5c.eb3134","name":"","topic":"","payload":"curl -H \"X-Api-Key: E7075122DA52487BBFCBE1C241CCE952\" -X GET http://192.168.1.7/ender1/api","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":240,"wires":[["47abc662.7ce8c8","480e5784.bee0a8"]]},{"id":"480e5784.bee0a8","type":"function","z":"5ff6ad5c.eb3134","name":"","func":"var mensaje={payload:\"printer\"}\nreturn mensaje;","outputs":1,"noerr":0,"x":150,"y":330,"wires":[["47abc662.7ce8c8"]]},{"id":"f5ad66f9.4839c8","type":"change","z":"d89bb856.b9ba88","name":"Op","rules":[{"t":"change","p":"payload","pt":"msg","from":"\"Printer is not operational\"","fromt":"str","to":"Desconectada","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":875,"y":285,"wires":[["4f71db9a.9b6bc4"]]},{"id":"35cea8d7.dc3c18","type":"debug","z":"780ee33d.d4e32c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":295,"y":735,"wires":[]},{"id":"3b12b210.bebcfe","type":"function","z":"780ee33d.d4e32c","name":"Home","func":"var AutoHome={payload:\"G28\\r\\n\"}\nreturn AutoHome;","outputs":1,"noerr":0,"x":260,"y":30,"wires":[["a66644f3.68c538"]]},{"id":"525e1496.104f9c","type":"ui_button","z":"780ee33d.d4e32c","name":"Auto Home","group":"a0bff555.3bebc8","order":7,"width":"2","height":"1","passthru":false,"label":"","tooltip":"","color":"","bgcolor":"","icon":"home","payload":"","payloadType":"str","topic":"","x":100,"y":30,"wires":[["3b12b210.bebcfe"]]},{"id":"2dd77e85.95bec2","type":"ui_text","z":"780ee33d.d4e32c","group":"a0bff555.3bebc8","order":6,"width":"8","height":"1","name":"","label":"Status : ","format":"{{msg.payload}}","layout":"row-center","x":705,"y":690,"wires":[]},{"id":"a66644f3.68c538","type":"serial out","z":"780ee33d.d4e32c","name":"","serial":"41959110.00eca","x":700,"y":180,"wires":[]},{"id":"fe233d19.f7591","type":"serial in","z":"780ee33d.d4e32c","name":"","serial":"41959110.00eca","x":85,"y":705,"wires":[["b0f9a360.13cf2","e0099be6.9fc1a8","35cea8d7.dc3c18"]]},{"id":"eeb21a08.4ea1a8","type":"function","z":"780ee33d.d4e32c","name":"Status Tem","func":"var Listar_archivos_SD={payload:\"M105\\r\\n\"}\nreturn Listar_archivos_SD;","outputs":1,"noerr":0,"x":280,"y":75,"wires":[["a66644f3.68c538"]]},{"id":"7f7338a6.0466e8","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":120,"wires":[["33abb5f5.6ae08a"]]},{"id":"b0f9a360.13cf2","type":"split","z":"780ee33d.d4e32c","name":"","splt":"/","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":275,"y":645,"wires":[["ddee1b50.f28d58"]]},{"id":"ddee1b50.f28d58","type":"split","z":"780ee33d.d4e32c","name":"","splt":" ","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":410,"y":645,"wires":[["5194000a.fbc62"]]},{"id":"5194000a.fbc62","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"T:","vt":"str"},{"t":"cont","v":"B:","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":545,"y":645,"wires":[["2a9cd9c2.a076e6"],["a2510fb5.065ef"]]},{"id":"a2510fb5.065ef","type":"split","z":"780ee33d.d4e32c","name":"Cama","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":695,"y":645,"wires":[["9b7b6475.42e2e8"]]},{"id":"2a9cd9c2.a076e6","type":"split","z":"780ee33d.d4e32c","name":"Extrusor","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":705,"y":600,"wires":[["ba267c55.609a3"]]},{"id":"ba267c55.609a3","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":845,"y":600,"wires":[["8a3452ae.589bb"]]},{"id":"9b7b6475.42e2e8","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":".","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":815,"y":645,"wires":[["f25c2734.d03678"]]},{"id":"e0099be6.9fc1a8","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"processing","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":275,"y":690,"wires":[["cd5136ed.0529a8"]]},{"id":"8a3452ae.589bb","type":"ui_gauge","z":"780ee33d.d4e32c","name":"","group":"a0bff555.3bebc8","order":3,"width":"6","height":"4","gtype":"gage","title":"Extrusor","label":"units","format":"{{value}}","min":0,"max":"250","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":975,"y":600,"wires":[]},{"id":"f25c2734.d03678","type":"ui_gauge","z":"780ee33d.d4e32c","name":"","group":"a0bff555.3bebc8","order":5,"width":"6","height":"4","gtype":"gage","title":"Cama","label":"units","format":"{{value}}","min":0,"max":"70","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":950,"y":645,"wires":[]},{"id":"62ef699a.cca218","type":"ui_button","z":"780ee33d.d4e32c","name":"Temperatura","group":"a0bff555.3bebc8","order":9,"width":"3","height":"1","passthru":false,"label":"Temperatura","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":100,"y":75,"wires":[["eeb21a08.4ea1a8"]]},{"id":"33abb5f5.6ae08a","type":"function","z":"780ee33d.d4e32c","name":"G00","func":"var Mover={payload:\"G00 X50 Y90 Z10\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":260,"y":120,"wires":[["a66644f3.68c538"]]},{"id":"fb77fd1c.231d7","type":"function","z":"780ee33d.d4e32c","name":"Info Firmaware","func":"var Info_firmaware={payload:\"M115\\r\\n\"}\nreturn Info_firmaware;","outputs":1,"noerr":0,"x":290,"y":165,"wires":[["a66644f3.68c538"]]},{"id":"254721c5.641e9e","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":165,"wires":[["fb77fd1c.231d7"]]},{"id":"10912f05.2fc2c1","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":210,"wires":[["241de004.631ad"]]},{"id":"241de004.631ad","type":"function","z":"780ee33d.d4e32c","name":"Escribir Archivo","func":"var Inicio={payload:\"M28 Ejemplo.gcode\\r\\n\"};\nvar Linea1={payload:\"G28\\r\\n\"};\nvar Linea2={payload:\"G00 X50 Y90 Z10\\r\\n\"};\nvar Linea3={payload:\"G00 X40 Y90 Z10\\r\\n\"};\nvar Linea4={payload:\"G00 X50 Y50 Z10\\r\\n\"};\nvar Fin={payload:\"M29\\r\\n\"};\nreturn [ [ Inicio, Linea1, Linea2, Linea3, Linea4, Fin ]];\n\n/*for(var i=0;i<=3;i++)\n{\n    return mensajes[i];\n}*/\n\n","outputs":1,"noerr":0,"x":290,"y":210,"wires":[["a66644f3.68c538"]]},{"id":"e5afbab1.d7d058","type":"function","z":"780ee33d.d4e32c","name":"Eliminar","func":"var Inicio={payload:\"M30 Ejemplo.gcode\\r\\n\"};\nvar Linea1={payload:\"M30 Ejemplo.txt\\r\\n\"};\nreturn Linea1;\n//return [ [ Inicio, Linea1 ]];\n\n","outputs":1,"noerr":0,"x":270,"y":255,"wires":[["a66644f3.68c538"]]},{"id":"ad6f4d6a.1e8cd","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":255,"wires":[["e5afbab1.d7d058"]]},{"id":"d6c00302.22b7","type":"exec","z":"32a6e9a4.729726","command":"ls","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":310,"y":80,"wires":[["276efe60.e43bc2"],[],[]]},{"id":"276efe60.e43bc2","type":"change","z":"32a6e9a4.729726","name":"split","rules":[{"t":"set","p":"payload","pt":"msg","to":"$split(payload, '\\n')[$ != \"\"]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":60,"wires":[[]]},{"id":"546a1b4c.34d3c4","type":"http in","z":"95bffdae.d288a","name":"","url":"/fileupload","method":"post","upload":true,"swaggerDoc":"","x":140,"y":440,"wires":[["d1581181.7008c","b5c4c3a.c48504"]]},{"id":"ce173b7a.59b848","type":"http response","z":"95bffdae.d288a","name":"","statusCode":"","headers":{},"x":850,"y":440,"wires":[]},{"id":"b93c3c46.c966b","type":"ui_template","z":"95bffdae.d288a","group":"9797b02c.7c8b6","name":"Upload","order":1,"width":"6","height":"3","format":"<form id=\"upload_form\" enctype=\"multipart/form-data\" method=\"post\">\n    <input type=\"file\" name=\"file1\" id=\"file1\"><br>\n    <input type=\"button\" value=\"Upload File\" onclick=\"uploadFile()\">\n    <progress id=\"progressBar\" value=\"0\" max=\"100\" style=\"width:300px;\"></progress>\n    <p id=\"status\"></p>\n    <p id=\"loaded_n_total\"></p>\n</form>\n\n<script>\n    function _(el){\n    return document.getElementById(el);\n}\nfunction uploadFile(){\n    var file = _(\"file1\").files[0];\n    // alert(file.name+\" | \"+file.size+\" | \"+file.type);\n    var formdata = new FormData();\n    formdata.append(\"file1\", file);\n    var ajax = new XMLHttpRequest();\n    ajax.upload.addEventListener(\"progress\", progressHandler, false);\n    ajax.addEventListener(\"load\", completeHandler, false);\n    ajax.addEventListener(\"error\", errorHandler, false);\n    ajax.addEventListener(\"abort\", abortHandler, false);\n    ajax.open(\"POST\", \"/fileupload\");\n    ajax.send(formdata);\n}\nfunction progressHandler(event){\n    _(\"loaded_n_total\").innerHTML = \"Uploaded \"+event.loaded+\" bytes of \"+event.total;\n    var percent = (event.loaded / event.total) * 100;\n    _(\"progressBar\").value = Math.round(percent);\n    _(\"status\").innerHTML = Math.round(percent)+\"% uploaded... please wait\";\n}\nfunction completeHandler(event){\n    _(\"status\").innerHTML = event.target.responseText;\n    _(\"progressBar\").value = 0;\n}\nfunction errorHandler(event){\n    _(\"status\").innerHTML = \"Upload Failed\";\n}\nfunction abortHandler(event){\n    _(\"status\").innerHTML = \"Upload Aborted\";\n}\n</script>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":120,"y":400,"wires":[[]]},{"id":"401a6c6f.228764","type":"subflow:32a6e9a4.729726","z":"95bffdae.d288a","name":"","env":[],"x":520,"y":140,"wires":[["a82a8c6b.831eb"]]},{"id":"dda50a49.28a8b8","type":"ui_dropdown","z":"95bffdae.d288a","name":"","label":"","tooltip":"","place":"Select option","group":"9797b02c.7c8b6","order":0,"width":0,"height":0,"passthru":true,"options":[{"label":"","value":"","type":"str"}],"payload":"","topic":"","x":890,"y":140,"wires":[["25692c33.216e64"]]},{"id":"a82a8c6b.831eb","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"options","pt":"msg","to":"payload","tot":"msg"},{"t":"delete","p":"payload","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":140,"wires":[["dda50a49.28a8b8"]]},{"id":"8dbdcfb.9fe483","type":"link in","z":"95bffdae.d288a","name":"refreshFileDropdown","links":["9e15981.7212a68","1e5aeecf.9d3091"],"x":75,"y":140,"wires":[["5900eeb8.22f3b"]]},{"id":"34918529.8c79fa","type":"ui_button","z":"95bffdae.d288a","name":"","group":"9797b02c.7c8b6","order":0,"width":0,"height":0,"passthru":false,"label":"Delete","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":110,"y":220,"wires":[["41cefd6.cccd404"]]},{"id":"25692c33.216e64","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"selectedFile","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1100,"y":140,"wires":[[]]},{"id":"d1581181.7008c","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"filename","pt":"msg","to":"$env('UPLOAD_DIR')  & '/' & req.files[0].originalname","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"req.files[0].buffer","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":360,"wires":[["ee1b9f6.931b16","9e15981.7212a68"]]},{"id":"ee1b9f6.931b16","type":"file","z":"95bffdae.d288a","name":"","filename":"","appendNewline":false,"createDir":false,"overwriteFile":"true","x":770,"y":360,"wires":[[]]},{"id":"e015547f.791248","type":"inject","z":"95bffdae.d288a","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":130,"y":80,"wires":[["5900eeb8.22f3b"]]},{"id":"41cefd6.cccd404","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"filename","pt":"msg","to":"$env('UPLOAD_DIR')  & '/' & $flowContext('selectedFile')","tot":"jsonata"},{"t":"set","p":"payload","pt":"msg","to":"Delete File ?","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":220,"wires":[["691de655.62c4e8"]]},{"id":"4764d947.92bcf8","type":"file","z":"95bffdae.d288a","name":"","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"delete","x":770,"y":220,"wires":[[]]},{"id":"691de655.62c4e8","type":"ui_toast","z":"95bffdae.d288a","position":"dialog","displayTime":"3","highlight":"","outputs":1,"ok":"OK","cancel":"Cancel","topic":"","name":"","x":470,"y":220,"wires":[["8d1384e.474fb78"]]},{"id":"8d1384e.474fb78","type":"switch","z":"95bffdae.d288a","name":"OK ?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"OK","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":630,"y":220,"wires":[["4764d947.92bcf8","1e5aeecf.9d3091"]]},{"id":"a92b5792.264778","type":"catch","z":"95bffdae.d288a","name":"","scope":null,"x":120,"y":500,"wires":[["d78629a0.810178"]]},{"id":"ae813e1f.4780e","type":"ui_toast","z":"95bffdae.d288a","position":"top right","displayTime":"3","highlight":"","outputs":0,"ok":"OK","cancel":"","topic":"","name":"","x":530,"y":500,"wires":[]},{"id":"d78629a0.810178","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"error.message","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":500,"wires":[["ae813e1f.4780e"]]},{"id":"1e5aeecf.9d3091","type":"link out","z":"95bffdae.d288a","name":"refreshAfterDelete","links":["8dbdcfb.9fe483"],"x":735,"y":260,"wires":[]},{"id":"9e15981.7212a68","type":"link out","z":"95bffdae.d288a","name":"refreshAfterUpload","links":["8dbdcfb.9fe483"],"x":735,"y":400,"wires":[]},{"id":"b5c4c3a.c48504","type":"change","z":"95bffdae.d288a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"'File ' & req.files[0].originalname & ' uploaded.'","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":440,"wires":[["ce173b7a.59b848"]]},{"id":"5900eeb8.22f3b","type":"delay","z":"95bffdae.d288a","name":"","pauseType":"delay","timeout":"100","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":190,"y":140,"wires":[["c950f136.4fa41"]]},{"id":"c950f136.4fa41","type":"change","z":"95bffdae.d288a","name":"basePath","rules":[{"t":"set","p":"payload","pt":"msg","to":"UPLOAD_DIR","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":140,"wires":[["401a6c6f.228764"]]},{"id":"443c6fa9.9433f","type":"watch","z":"95bffdae.d288a","name":"","files":"$(UPLOAD_DIR)","recursive":"","x":140,"y":40,"wires":[["5900eeb8.22f3b"]]},{"id":"cd5136ed.0529a8","type":"split","z":"780ee33d.d4e32c","name":"","splt":":","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":425,"y":690,"wires":[["ecbc730f.c8efc"]]},{"id":"ecbc730f.c8efc","type":"switch","z":"780ee33d.d4e32c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"processing","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":545,"y":690,"wires":[["2dd77e85.95bec2"]]},{"id":"57159658.2e1578","type":"function","z":"780ee33d.d4e32c","name":"Status Impresion SD","func":"var Mover={payload:\"M27\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":310,"y":300,"wires":[["a66644f3.68c538"]]},{"id":"44a60f63.cb17d","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":300,"wires":[["57159658.2e1578"]]},{"id":"93e6aba4.bd8fa8","type":"function","z":"780ee33d.d4e32c","name":"Archivos SD","func":"var Mover={payload:\"M20\\r\\n\"}\nreturn Mover;","outputs":1,"noerr":0,"x":280,"y":345,"wires":[["a66644f3.68c538"]]},{"id":"4db2c4f.d25433c","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":345,"wires":[["93e6aba4.bd8fa8"]]},{"id":"f3a92d1b.79d23","type":"function","z":"780ee33d.d4e32c","name":"Imprimir Archivo desde SD","func":"var Inicio={payload:\"M23 CE3_PI~1.GCO\\r\\n\"};\nvar Fin={payload:\"M24\\r\\n\"};\nreturn [ [ Inicio, Fin ]];\n\n/*for(var i=0;i<=3;i++)\n{\n    return mensajes[i];\n}*/\n\n","outputs":1,"noerr":0,"x":330,"y":390,"wires":[["a66644f3.68c538"]]},{"id":"ebbd5ca5.04ff7","type":"inject","z":"780ee33d.d4e32c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":105,"y":390,"wires":[["f3a92d1b.79d23"]]}]